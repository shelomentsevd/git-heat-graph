#!/bin/bash

# Constants
EMPTY='\033[0m ' # Hadn't commits on this day
LOW='\033[1;32m\u25A0\033[0m' # At least one
NORMAL='\033[1;33m\u25A0\033[0m' # 1/max(commits)
ONFIRE='\033[0;32m\u25A0\033[0m' # max(commits)

# Current date
currentDate=`date +%Y-%m-%d`
# Date year ago
dateYearAgo=`date "--date=${date} -1 year" +%Y-%m-%d`

counter=0
tmpDate=$dateYearAgo
# Offset
X=0
Y=0
OffsetX=0
OffsetY=0
# Clear screen, set cursor position
tput clear;tput cup $X $Y
week=0
month=`date "--date=${tmpDate}" +%m`
while [ "$tmpDate" != "$currentDate" ]
do
    let "counter=$counter + 1"
    let "Y=($counter/7) + $OffsetY"
    let "X=$week + $OffsetX"
    let "week=$week+1"

    tmpDate=`date "--date=$tmpDate +1 day" +%Y-%m-%d`

    tput cup $X $Y;echo -e "${LOW}"
    currentMonth=`date "--date=${tmpDate}" +%m`
    if [ $month -ne $currentMonth ]
    then
        let "OffsetY=$OffsetY+1"
        month=$currentMonth
    fi
    if [ $week -eq 7 ]
    then
        week=0
        let "OffsetY=$OffsetY+1"
    fi
    #echo -e "Y: $Y X:$X O:$Offset W:$week"
done
let "X=$X + 7"
tput cup $X 0